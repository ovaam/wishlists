<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç Firebase</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        button {
            padding: 15px 30px;
            font-size: 16px;
            background: #8B1538;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin: 20px 0;
        }
        button:hover {
            background: #7B1A3A;
        }
        #result {
            margin-top: 20px;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 8px;
            font-family: monospace;
            line-height: 1.6;
        }
        .info {
            margin-top: 20px;
            padding: 15px;
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h1>–¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è Firebase</h1>
    <button onclick="testFirebase()" style="padding: 15px 30px; font-size: 16px; background: #8B1538; color: white; border: none; border-radius: 8px; cursor: pointer; margin: 20px 0;">üîç –¢–µ—Å—Ç Firebase</button>
    <div id="result" style="margin-top: 20px; padding: 20px; background: #f5f5f5; border-radius: 8px; font-family: monospace;"></div>
    <div style="margin-top: 20px; padding: 15px; background: #fff3cd; border-left: 4px solid #ffc107; border-radius: 4px;">
        <strong>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</strong><br>
        1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–¢–µ—Å—Ç Firebase" –≤—ã—à–µ<br>
        2. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12 –∏–ª–∏ Cmd+Option+I)<br>
        3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞ –Ω–∏–∂–µ
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyB70EQaWcZWaEi9r70hZtq9c11CUHjDZbs",
            authDomain: "wishlist-8d5ee.firebaseapp.com",
            databaseURL: "https://wishlist-8d5ee-default-rtdb.europe-west1.firebasedatabase.app/",
            projectId: "wishlist-8d5ee",
            storageBucket: "wishlist-8d5ee.firebasestorage.app",
            messagingSenderId: "548837942324",
            appId: "1:548837942324:web:e462f7010f395d9d89d661",
            measurementId: "G-XYD7ERDPBS"
        };

        function testFirebase() {
            const result = document.getElementById('result');
            result.innerHTML = '<p>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...</p>';
            
            try {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ SDK
                if (typeof firebase === 'undefined') {
                    result.innerHTML = '<p style="color:red">‚ùå Firebase SDK –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω!</p>';
                    return;
                }
                result.innerHTML += '<p style="color:green">‚úÖ Firebase SDK –∑–∞–≥—Ä—É–∂–µ–Ω</p>';
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
                const app = firebase.initializeApp(firebaseConfig);
                const database = firebase.database();
                result.innerHTML += '<p style="color:green">‚úÖ Firebase –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω</p>';
                result.innerHTML += '<p style="color:blue">Database URL: ' + firebaseConfig.databaseURL + '</p>';
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
                database.ref('.info/serverTimeOffset').once('value')
                    .then(() => {
                        result.innerHTML += '<p style="color:green">‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞</p>';
                    })
                    .catch((error) => {
                        result.innerHTML += '<p style="color:red">‚ùå –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞: ' + error.message + '</p>';
                        result.innerHTML += '<p style="color:red">–ö–æ–¥ –æ—à–∏–±–∫–∏: ' + error.code + '</p>';
                    });
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
                let connectionChecked = false;
                database.ref('.info/connected').on('value', (snapshot) => {
                    if (snapshot.val() === true) {
                        result.innerHTML += '<p style="color:green">‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ Firebase</p>';
                        connectionChecked = true;
                    } else {
                        if (!connectionChecked) {
                            result.innerHTML += '<p style="color:orange">‚ö†Ô∏è –û–∂–∏–¥–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...</p>';
                            // –ü–æ–ø—Ä–æ–±—É–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                            setTimeout(() => {
                                if (!connectionChecked) {
                                    result.innerHTML += '<p style="color:red">‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Firebase</p>';
                                    result.innerHTML += '<p style="color:orange">–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:</p>';
                                    result.innerHTML += '<ul style="color:orange">';
                                    result.innerHTML += '<li>–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ</li>';
                                    result.innerHTML += '<li>–ü—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ Firebase Console</li>';
                                    result.innerHTML += '<li>–ë–ª–æ–∫–∏—Ä–æ–≤–∫—É —Ñ–∞–π—Ä–≤–æ–ª–æ–º/–∞–Ω—Ç–∏–≤–∏—Ä—É—Å–æ–º</li>';
                                    result.innerHTML += '</ul>';
                                }
                            }, 3000);
                        }
                    }
                });
                
                // –¢–µ—Å—Ç –∑–∞–ø–∏—Å–∏
                const testData = {
                    test: 'Hello Firebase!',
                    timestamp: new Date().toISOString()
                };
                
                // –ñ–¥–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é
                setTimeout(() => {
                    database.ref('test').set(testData)
                        .then(() => {
                            result.innerHTML += '<p style="color:green">‚úÖ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∞–Ω—ã –≤ Firebase!</p>';
                            
                            // –¢–µ—Å—Ç —á—Ç–µ–Ω–∏—è
                            database.ref('test').once('value', (snapshot) => {
                                const data = snapshot.val();
                                result.innerHTML += '<p style="color:green">‚úÖ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—á–∏—Ç–∞–Ω—ã: ' + JSON.stringify(data) + '</p>';
                                result.innerHTML += '<p style="color:green; font-weight:bold;">üéâ Firebase —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ!</p>';
                            });
                        })
                        .catch((error) => {
                            result.innerHTML += '<p style="color:red">‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø–∏—Å–∏: ' + error.message + '</p>';
                            result.innerHTML += '<p style="color:red">–ö–æ–¥ –æ—à–∏–±–∫–∏: ' + error.code + '</p>';
                            if (error.code === 'PERMISSION_DENIED') {
                                result.innerHTML += '<p style="color:red; font-weight:bold;">‚ö†Ô∏è –û–®–ò–ë–ö–ê: PERMISSION_DENIED</p>';
                                result.innerHTML += '<p style="color:orange">–ù—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ Firebase Console:</p>';
                                result.innerHTML += '<ol style="color:orange">';
                                result.innerHTML += '<li>–û—Ç–∫—Ä–æ–π—Ç–µ <a href="https://console.firebase.google.com" target="_blank">Firebase Console</a></li>';
                                result.innerHTML += '<li>–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç wishlist-8d5ee</li>';
                                result.innerHTML += '<li>Realtime Database ‚Üí Rules</li>';
                                result.innerHTML += '<li>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∏–ª–∞:<br><code style="background:#fff;padding:5px;display:block;margin:5px 0;">{"rules": {".read": true, ".write": true}}</code></li>';
                                result.innerHTML += '<li>–ù–∞–∂–º–∏—Ç–µ "Publish"</li>';
                                result.innerHTML += '</ol>';
                            } else {
                                result.innerHTML += '<p style="color:orange">–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑</p>';
                            }
                        });
                }, 2000);
                    
            } catch (e) {
                result.innerHTML += '<p style="color:red">‚ùå –û—à–∏–±–∫–∞: ' + e.message + '</p>';
            }
        }
    </script>
</body>
</html>

